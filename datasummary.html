<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Paul Schrimpf, Hiro Kasahara, Victor Chernozhukov" />


<title>Data</title>

<script src="site_libs/header-attrs-2.5/header-attrs.js"></script>
<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/journal.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="site_libs/anchor-sections-1.0/anchor-sections.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 61px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h2 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h3 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h4 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h5 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h6 {
  padding-top: 66px;
  margin-top: -66px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">COVID policies, behavior, and infection growth</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="datasummary.html">Data summary</a>
</li>
<li>
  <a href="regressionsWithPlots.html">Regresssions</a>
</li>
<li>
  <a href="cf-pindex.html">Counterfactuals</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Data</h1>
<h3 class="subtitle">Data description and summary statistics</h3>
<h4 class="author">Paul Schrimpf, Hiro Kasahara, Victor Chernozhukov</h4>
<h4 class="date">22 February, 2021</h4>

</div>


<pre class="r"><code>library(ggthemes)
library(ggplot2)
library(gridExtra)
library(knitr)
library(kableExtra)
library(latex2exp)
library(plm)
library(lubridate)

rootdir &lt;- system(&quot;git rev-parse --show-toplevel&quot;, intern=TRUE)[1]
datafile &lt;- paste(rootdir,&quot;cases_and_policies/data/covidstates.Rda&quot;, sep=&quot;/&quot;)
cat(&quot;Loading data last updated on &quot;, as.character(file.mtime(datafile)), &quot;\n&quot;)</code></pre>
<pre><code>## Loading data last updated on  2020-09-11 09:51:34</code></pre>
<pre class="r"><code>cat(&quot;Run &quot;, paste(rootdir,&quot;cases_and_policies/R/cases_and_policies.R&quot;, sep=&quot;/&quot;), &quot; to update data.\n&quot;)</code></pre>
<pre><code>## Run  /home/paul/covid-impact/cases_and_policies/R/cases_and_policies.R  to update data.</code></pre>
<pre class="r"><code>load(datafile)
source(paste(rootdir,&quot;cases_and_policies/R/utils.R&quot;,sep=&quot;/&quot;))
source(paste(rootdir,&quot;cases_and_policies/rmd/varlabels.R&quot;, sep=&quot;/&quot;))

plottheme &lt;- figtheme
colors &lt;-  scale_color_solarized

kable &lt;- function(tbl, ...) kable_styling(knitr::kable(tbl, ...),
                                          bootstrap_options=c(&quot;striped&quot;,&quot;condensed&quot;,&quot;responsive&quot;),
                                          full_width=TRUE)

cs &lt;- covidstates
cs &lt;- cs[cs$fips&lt;60, ] # drop territories (Puerto Rico, Guam, etc)
cs &lt;- cs[order(cs$state, cs$date),]</code></pre>
<div id="comparing-datasets-on-cases-and-deaths" class="section level1" number="1">
<h1 number="1"><span class="header-section-number">1</span> Comparing Datasets on Cases and Deaths</h1>
<pre class="r"><code>vars &lt;- c(&quot;cases.nyt&quot;,&quot;cases&quot;,&quot;positive&quot;)
tbl &lt;- cor(cs[,vars],use=&quot;complete&quot;)
rownames(tbl) &lt;- colnames(tbl) &lt;- c(&quot;NYT&quot;,&quot;JHU&quot;,&quot;CTP&quot;)
kable(tbl, digits=5, caption=&quot;Correlation of cumulative cases \\label{tab:casecor}&quot;)</code></pre>
<pre><code>## Warning in kable_styling(knitr::kable(tbl, ...), bootstrap_options = c(&quot;striped&quot;, : Please specify format in kable. kableExtra can
## customize either HTML or LaTeX outputs. See https://haozhu233.github.io/kableExtra/ for details.</code></pre>
<table>
<caption>Correlation of cumulative cases </caption>
<thead>
<tr class="header">
<th></th>
<th align="right">NYT</th>
<th align="right">JHU</th>
<th align="right">CTP</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>NYT</td>
<td align="right">1.00000</td>
<td align="right">0.99985</td>
<td align="right">0.99970</td>
</tr>
<tr class="even">
<td>JHU</td>
<td align="right">0.99985</td>
<td align="right">1.00000</td>
<td align="right">0.99985</td>
</tr>
<tr class="odd">
<td>CTP</td>
<td align="right">0.99970</td>
<td align="right">0.99985</td>
<td align="right">1.00000</td>
</tr>
</tbody>
</table>
<pre class="r"><code>tbl2 &lt;- matrix(NA,3,3)
for(i in 1:3) {
  for(j in 1:3) {
    tbl2[i,j] &lt;- mean(cs[,vars[i]]==cs[,vars[j]], na.rm=TRUE)
  }
}
rownames(tbl2) &lt;- rownames(tbl)
colnames(tbl2) &lt;- colnames(tbl)
kable(tbl2, digits=5,
      caption=&quot;Portion of days that cumulative cases are equal between data sets \\label{tab:eqcases}&quot;)</code></pre>
<pre><code>## Warning in kable_styling(knitr::kable(tbl, ...), bootstrap_options = c(&quot;striped&quot;, : Please specify format in kable. kableExtra can
## customize either HTML or LaTeX outputs. See https://haozhu233.github.io/kableExtra/ for details.</code></pre>
<table>
<caption>Portion of days that cumulative cases are equal between data sets </caption>
<thead>
<tr class="header">
<th></th>
<th align="right">NYT</th>
<th align="right">JHU</th>
<th align="right">CTP</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>NYT</td>
<td align="right">1.00000</td>
<td align="right">0.38245</td>
<td align="right">0.31630</td>
</tr>
<tr class="even">
<td>JHU</td>
<td align="right">0.38245</td>
<td align="right">1.00000</td>
<td align="right">0.51413</td>
</tr>
<tr class="odd">
<td>CTP</td>
<td align="right">0.31630</td>
<td align="right">0.51413</td>
<td align="right">1.00000</td>
</tr>
</tbody>
</table>
<div id="daily-cases" class="section level2" number="1.1">
<h2 number="1.1"><span class="header-section-number">1.1</span> Daily Cases</h2>
<pre class="r"><code>startday &lt;- as.Date(&quot;2020-02-15&quot;)
cs$newcases.nyt &lt;- paneldiff(cs$cases.nyt, cs$state, cs$date, lag=1)
cs$newcases.jhu &lt;- paneldiff(cs$cases, cs$state, cs$date, lag=1)
cs$newcases.ctp &lt;- paneldiff(cs$positive, cs$state, cs$date, lag=1)

fctp &lt;- ggplot(cs, aes(x=date, y=newcases.ctp, colour=state)) + geom_line(alpha=1) +
  xlim(as.Date(startday),max(cs$date)) + scale_y_log10() + plottheme +
  ggtitle(&quot;CTP&quot;) + ylab(&quot;New cases&quot;) +
  theme(legend.position = &quot;none&quot;)
fnyt &lt;- ggplot(cs, aes(x=date, y=newcases.nyt, colour=state)) + geom_line(alpha=1) +
  xlim(as.Date(startday),max(cs$date)) + scale_y_log10() + plottheme +
  ggtitle(&quot;NYT&quot;) + ylab(&quot;New cases&quot;) +
  theme(legend.position = &quot;none&quot;)
fjhu &lt;- ggplot(cs, aes(x=date, y=newcases.jhu, colour=state)) + geom_line(alpha=1) +
  xlim(as.Date(startday),max(cs$date)) + scale_y_log10() + plottheme +
  ggtitle(&quot;JHU&quot;) + ylab(&quot;New cases&quot;) +
  theme(legend.position = &quot;none&quot;)

grid.arrange(fnyt,fjhu,fctp)</code></pre>
<pre><code>## Warning in self$trans$transform(x): NaNs produced</code></pre>
<pre><code>## Warning: Transformation introduced infinite values in continuous y-axis</code></pre>
<pre><code>## Warning: Removed 2230 row(s) containing missing values (geom_path).</code></pre>
<pre><code>## Warning in self$trans$transform(x): NaNs produced</code></pre>
<pre><code>## Warning: Transformation introduced infinite values in continuous y-axis</code></pre>
<pre><code>## Warning: Removed 1276 row(s) containing missing values (geom_path).</code></pre>
<pre><code>## Warning in self$trans$transform(x): NaNs produced</code></pre>
<pre><code>## Warning: Transformation introduced infinite values in continuous y-axis</code></pre>
<pre><code>## Warning: Removed 2252 row(s) containing missing values (geom_path).</code></pre>
<p><img src="datasummary_files/figure-html/newcases-1.png" width="768" /></p>
<pre class="r"><code>X  &lt;- cs[,c(&quot;newcases.nyt&quot;,&quot;newcases.jhu&quot;,&quot;newcases.ctp&quot;)]
X[X&lt;0] &lt;- NA
X[X==0] &lt;- 0.1
tbl  &lt;- colSums(cs[,c(&quot;newcases.nyt&quot;,&quot;newcases.jhu&quot;,&quot;newcases.ctp&quot;)]&lt;0, na.rm=TRUE)
tbl &lt;- cor(log(X), use=&quot;complete&quot;)
tbl &lt;- rbind(tbl, diag(cov(log(X), use=&quot;complete&quot;)))
colnames(tbl) &lt;- c(&quot;NYT&quot;,&quot;JHU&quot;,&quot;CTP&quot;)
rownames(tbl) &lt;- c(&quot;NYT&quot;,&quot;JHU&quot;,&quot;CTP&quot;,&quot;Variance&quot;)

kable(tbl, digits=4, caption=&quot;Correlation and variance of log daily new cases\\label{tab:newcasecor}&quot;)</code></pre>
<pre><code>## Warning in kable_styling(knitr::kable(tbl, ...), bootstrap_options = c(&quot;striped&quot;, : Please specify format in kable. kableExtra can
## customize either HTML or LaTeX outputs. See https://haozhu233.github.io/kableExtra/ for details.</code></pre>
<table>
<caption>Correlation and variance of log daily new cases</caption>
<thead>
<tr class="header">
<th></th>
<th align="right">NYT</th>
<th align="right">JHU</th>
<th align="right">CTP</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>NYT</td>
<td align="right">1.0000</td>
<td align="right">0.9299</td>
<td align="right">0.8550</td>
</tr>
<tr class="even">
<td>JHU</td>
<td align="right">0.9299</td>
<td align="right">1.0000</td>
<td align="right">0.8237</td>
</tr>
<tr class="odd">
<td>CTP</td>
<td align="right">0.8550</td>
<td align="right">0.8237</td>
<td align="right">1.0000</td>
</tr>
<tr class="even">
<td>Variance</td>
<td align="right">5.0527</td>
<td align="right">5.8091</td>
<td align="right">6.1117</td>
</tr>
</tbody>
</table>
</div>
<div id="weekly-cases" class="section level2" number="1.2">
<h2 number="1.2"><span class="header-section-number">1.2</span> Weekly Cases</h2>
<pre class="r"><code>cs$newcases.nyt &lt;- paneldiff(cs$cases.nyt, cs$state, cs$date, lag=7)
cs$newcases.jhu &lt;- paneldiff(cs$cases, cs$state, cs$date, lag=7)
cs$newcases.ctp &lt;- paneldiff(cs$positive, cs$state, cs$date, lag=7)
X  &lt;- cs[,c(&quot;newcases.nyt&quot;,&quot;newcases.jhu&quot;,&quot;newcases.ctp&quot;)]
X[X&lt;0] &lt;- NA
X[X==0] &lt;- 0.1
tbl  &lt;- colSums(cs[,c(&quot;newcases.nyt&quot;,&quot;newcases.jhu&quot;,&quot;newcases.ctp&quot;)]&lt;0, na.rm=TRUE)
tbl &lt;- cor(log(X), use=&quot;complete&quot;)
tbl &lt;- rbind(tbl, diag(cov(log(X), use=&quot;complete&quot;)))
colnames(tbl) &lt;- c(&quot;NYT&quot;,&quot;JHU&quot;,&quot;CTP&quot;)
rownames(tbl) &lt;- c(&quot;NYT&quot;,&quot;JHU&quot;,&quot;CTP&quot;,&quot;Variance&quot;)
kable(tbl, digits=4, caption=&quot;Correlation and variance of log weekly new cases\\label{tab:weekcasecor}&quot;)</code></pre>
<pre><code>## Warning in kable_styling(knitr::kable(tbl, ...), bootstrap_options = c(&quot;striped&quot;, : Please specify format in kable. kableExtra can
## customize either HTML or LaTeX outputs. See https://haozhu233.github.io/kableExtra/ for details.</code></pre>
<table>
<caption>Correlation and variance of log weekly new cases</caption>
<thead>
<tr class="header">
<th></th>
<th align="right">NYT</th>
<th align="right">JHU</th>
<th align="right">CTP</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>NYT</td>
<td align="right">1.0000</td>
<td align="right">0.9965</td>
<td align="right">0.9831</td>
</tr>
<tr class="even">
<td>JHU</td>
<td align="right">0.9965</td>
<td align="right">1.0000</td>
<td align="right">0.9794</td>
</tr>
<tr class="odd">
<td>CTP</td>
<td align="right">0.9831</td>
<td align="right">0.9794</td>
<td align="right">1.0000</td>
</tr>
<tr class="even">
<td>Variance</td>
<td align="right">3.6815</td>
<td align="right">3.7630</td>
<td align="right">3.4723</td>
</tr>
</tbody>
</table>
<pre class="r"><code>fctp &lt;- ggplot(cs, aes(x=date, y=newcases.ctp, colour=state)) + geom_line(alpha=1) +
  xlim(startday,max(cs$date)) + scale_y_log10() + plottheme +
  ggtitle(&quot;CTP&quot;) + ylab(&quot;New cases&quot;) +
  theme(legend.position = &quot;none&quot;)
fnyt &lt;- ggplot(cs, aes(x=date, y=newcases.nyt, colour=state)) + geom_line(alpha=1) +
  xlim(startday,max(cs$date)) + scale_y_log10() + plottheme +
  ggtitle(&quot;NYT&quot;) + ylab(&quot;New cases&quot;) +
  theme(legend.position = &quot;none&quot;)
fjhu &lt;- ggplot(cs, aes(x=date, y=newcases.jhu, colour=state)) + geom_line(alpha=1) +
  xlim(startday,max(cs$date)) + scale_y_log10() + plottheme +
  ggtitle(&quot;JHU&quot;) + ylab(&quot;New cases&quot;) +
  theme(legend.position = &quot;none&quot;)

grid.arrange(fnyt,fjhu,fctp)</code></pre>
<pre><code>## Warning: Transformation introduced infinite values in continuous y-axis</code></pre>
<pre><code>## Warning: Removed 2498 row(s) containing missing values (geom_path).</code></pre>
<pre><code>## Warning: Transformation introduced infinite values in continuous y-axis</code></pre>
<pre><code>## Warning: Removed 1276 row(s) containing missing values (geom_path).</code></pre>
<pre><code>## Warning: Transformation introduced infinite values in continuous y-axis</code></pre>
<pre><code>## Warning: Removed 2552 row(s) containing missing values (geom_path).</code></pre>
<p><img src="datasummary_files/figure-html/unnamed-chunk-2-1.png" width="768" /></p>
</div>
<div id="deaths" class="section level2" number="1.3">
<h2 number="1.3"><span class="header-section-number">1.3</span> Deaths</h2>
<pre class="r"><code>cs$newdeaths.nyt &lt;- paneldiff(cs$deaths.nyt, cs$state, cs$date, lag=7)
cs$newdeaths.jhu &lt;- paneldiff(cs$deaths, cs$state, cs$date, lag=7)
cs$newdeaths.ctp &lt;- paneldiff(cs$deaths.ctp, cs$state, cs$date, lag=7)
X  &lt;- cs[,c(&quot;newdeaths.nyt&quot;,&quot;newdeaths.jhu&quot;,&quot;newdeaths.ctp&quot;)]
tbl  &lt;- colSums(cs[,c(&quot;newdeaths.nyt&quot;,&quot;newdeaths.jhu&quot;,&quot;newdeaths.ctp&quot;)]&lt;0, na.rm=TRUE)
tbl &lt;- cor(X, use=&quot;complete&quot;)
tbl &lt;- rbind(tbl, diag(cov(X, use=&quot;complete&quot;)))
colnames(tbl) &lt;- c(&quot;NYT&quot;,&quot;JHU&quot;,&quot;CTP&quot;)
rownames(tbl) &lt;- c(&quot;NYT&quot;,&quot;JHU&quot;,&quot;CTP&quot;,&quot;Variance&quot;)
kable(tbl, digits=4, caption=&quot;Correlation and variance of weekly deaths\\label{tab:weekdeathcor}&quot;)</code></pre>
<pre><code>## Warning in kable_styling(knitr::kable(tbl, ...), bootstrap_options = c(&quot;striped&quot;, : Please specify format in kable. kableExtra can
## customize either HTML or LaTeX outputs. See https://haozhu233.github.io/kableExtra/ for details.</code></pre>
<table>
<caption>Correlation and variance of weekly deaths</caption>
<thead>
<tr class="header">
<th></th>
<th align="right">NYT</th>
<th align="right">JHU</th>
<th align="right">CTP</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>NYT</td>
<td align="right">1.0000</td>
<td align="right">0.9797</td>
<td align="right">0.9732</td>
</tr>
<tr class="even">
<td>JHU</td>
<td align="right">0.9797</td>
<td align="right">1.0000</td>
<td align="right">0.9819</td>
</tr>
<tr class="odd">
<td>CTP</td>
<td align="right">0.9732</td>
<td align="right">0.9819</td>
<td align="right">1.0000</td>
</tr>
<tr class="even">
<td>Variance</td>
<td align="right">172292.1476</td>
<td align="right">174310.0720</td>
<td align="right">126952.9432</td>
</tr>
</tbody>
</table>
<pre class="r"><code>fctp &lt;- ggplot(cs, aes(x=date, y=newdeaths.ctp, colour=state)) + geom_line(alpha=1) +
  xlim(startday,max(cs$date)) + scale_y_log10() + plottheme +
  ggtitle(&quot;CTP&quot;) + ylab(&quot;Deaths&quot;) +
  theme(legend.position = &quot;none&quot;)
fnyt &lt;- ggplot(cs, aes(x=date, y=newdeaths.nyt, colour=state)) + geom_line(alpha=1) +
  xlim(startday,max(cs$date)) + scale_y_log10() + plottheme +
  ggtitle(&quot;NYT&quot;) + ylab(&quot;Deaths&quot;) +
  theme(legend.position = &quot;none&quot;)
fjhu &lt;- ggplot(cs, aes(x=date, y=newdeaths.jhu, colour=state)) + geom_line(alpha=1) +
  xlim(startday,max(cs$date)) + scale_y_log10() + plottheme +
  ggtitle(&quot;JHU&quot;) + ylab(&quot;Deaths&quot;) +
  theme(legend.position = &quot;none&quot;)

grid.arrange(fnyt,fjhu,fctp)</code></pre>
<pre><code>## Warning in self$trans$transform(x): NaNs produced</code></pre>
<pre><code>## Warning: Transformation introduced infinite values in continuous y-axis</code></pre>
<pre><code>## Warning: Removed 2498 row(s) containing missing values (geom_path).</code></pre>
<pre><code>## Warning in self$trans$transform(x): NaNs produced</code></pre>
<pre><code>## Warning: Transformation introduced infinite values in continuous y-axis</code></pre>
<pre><code>## Warning: Removed 1276 row(s) containing missing values (geom_path).</code></pre>
<pre><code>## Warning in self$trans$transform(x): NaNs produced</code></pre>
<pre><code>## Warning: Transformation introduced infinite values in continuous y-axis</code></pre>
<pre><code>## Warning: Removed 3177 row(s) containing missing values (geom_path).</code></pre>
<p><img src="datasummary_files/figure-html/deathplots-1.png" width="768" /></p>
</div>
</div>
<div id="testing-data" class="section level1" number="2">
<h1 number="2"><span class="header-section-number">2</span> Testing data</h1>
<p>Our data on tests is from the <a href="https://covidtracking.com/">Covid Tracking Project</a>. This dataset contains the following variables.</p>
<pre class="r"><code>kable(dataguide[dataguide$source==&quot;Covid-Tracking Project&quot;,c(&quot;name&quot;,&quot;source&quot;)])</code></pre>
<pre><code>## Warning in kable_styling(knitr::kable(tbl, ...), bootstrap_options = c(&quot;striped&quot;, : Please specify format in kable. kableExtra can
## customize either HTML or LaTeX outputs. See https://haozhu233.github.io/kableExtra/ for details.</code></pre>
<table>
<thead>
<tr class="header">
<th></th>
<th align="left">name</th>
<th align="left">source</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>19</td>
<td align="left">positive</td>
<td align="left">Covid-Tracking Project</td>
</tr>
<tr class="even">
<td>20</td>
<td align="left">negative</td>
<td align="left">Covid-Tracking Project</td>
</tr>
<tr class="odd">
<td>21</td>
<td align="left">pending</td>
<td align="left">Covid-Tracking Project</td>
</tr>
<tr class="even">
<td>22</td>
<td align="left">hospitalizedCurrently</td>
<td align="left">Covid-Tracking Project</td>
</tr>
<tr class="odd">
<td>23</td>
<td align="left">hospitalizedCumulative</td>
<td align="left">Covid-Tracking Project</td>
</tr>
<tr class="even">
<td>24</td>
<td align="left">inIcuCurrently</td>
<td align="left">Covid-Tracking Project</td>
</tr>
<tr class="odd">
<td>25</td>
<td align="left">inIcuCumulative</td>
<td align="left">Covid-Tracking Project</td>
</tr>
<tr class="even">
<td>26</td>
<td align="left">onVentilatorCurrently</td>
<td align="left">Covid-Tracking Project</td>
</tr>
<tr class="odd">
<td>27</td>
<td align="left">onVentilatorCumulative</td>
<td align="left">Covid-Tracking Project</td>
</tr>
<tr class="even">
<td>28</td>
<td align="left">recovered.ctp</td>
<td align="left">Covid-Tracking Project</td>
</tr>
<tr class="odd">
<td>29</td>
<td align="left">dataQualityGrade</td>
<td align="left">Covid-Tracking Project</td>
</tr>
<tr class="even">
<td>30</td>
<td align="left">lastUpdateEt</td>
<td align="left">Covid-Tracking Project</td>
</tr>
<tr class="odd">
<td>31</td>
<td align="left">dateModified</td>
<td align="left">Covid-Tracking Project</td>
</tr>
<tr class="even">
<td>32</td>
<td align="left">checkTimeEt</td>
<td align="left">Covid-Tracking Project</td>
</tr>
<tr class="odd">
<td>33</td>
<td align="left">deaths.ctp</td>
<td align="left">Covid-Tracking Project</td>
</tr>
<tr class="even">
<td>34</td>
<td align="left">hospitalized</td>
<td align="left">Covid-Tracking Project</td>
</tr>
<tr class="odd">
<td>35</td>
<td align="left">dateChecked</td>
<td align="left">Covid-Tracking Project</td>
</tr>
<tr class="even">
<td>36</td>
<td align="left">totalTestsViral</td>
<td align="left">Covid-Tracking Project</td>
</tr>
<tr class="odd">
<td>37</td>
<td align="left">positiveTestsViral</td>
<td align="left">Covid-Tracking Project</td>
</tr>
<tr class="even">
<td>38</td>
<td align="left">negativeTestsViral</td>
<td align="left">Covid-Tracking Project</td>
</tr>
<tr class="odd">
<td>39</td>
<td align="left">positiveCasesViral</td>
<td align="left">Covid-Tracking Project</td>
</tr>
<tr class="even">
<td>40</td>
<td align="left">deathConfirmed</td>
<td align="left">Covid-Tracking Project</td>
</tr>
<tr class="odd">
<td>41</td>
<td align="left">deathProbable</td>
<td align="left">Covid-Tracking Project</td>
</tr>
<tr class="even">
<td>42</td>
<td align="left">totalTestEncountersViral</td>
<td align="left">Covid-Tracking Project</td>
</tr>
<tr class="odd">
<td>43</td>
<td align="left">totalTestsPeopleViral</td>
<td align="left">Covid-Tracking Project</td>
</tr>
<tr class="even">
<td>44</td>
<td align="left">totalTestsAntibody</td>
<td align="left">Covid-Tracking Project</td>
</tr>
<tr class="odd">
<td>45</td>
<td align="left">positiveTestsAntibody</td>
<td align="left">Covid-Tracking Project</td>
</tr>
<tr class="even">
<td>46</td>
<td align="left">negativeTestsAntibody</td>
<td align="left">Covid-Tracking Project</td>
</tr>
<tr class="odd">
<td>47</td>
<td align="left">totalTestsPeopleAntibody</td>
<td align="left">Covid-Tracking Project</td>
</tr>
<tr class="even">
<td>48</td>
<td align="left">positiveTestsPeopleAntibody</td>
<td align="left">Covid-Tracking Project</td>
</tr>
<tr class="odd">
<td>49</td>
<td align="left">negativeTestsPeopleAntibody</td>
<td align="left">Covid-Tracking Project</td>
</tr>
<tr class="even">
<td>50</td>
<td align="left">totalTestsPeopleAntigen</td>
<td align="left">Covid-Tracking Project</td>
</tr>
<tr class="odd">
<td>51</td>
<td align="left">positiveTestsPeopleAntigen</td>
<td align="left">Covid-Tracking Project</td>
</tr>
<tr class="even">
<td>52</td>
<td align="left">totalTestsAntigen</td>
<td align="left">Covid-Tracking Project</td>
</tr>
<tr class="odd">
<td>53</td>
<td align="left">positiveTestsAntigen</td>
<td align="left">Covid-Tracking Project</td>
</tr>
<tr class="even">
<td>54</td>
<td align="left">positiveIncrease</td>
<td align="left">Covid-Tracking Project</td>
</tr>
<tr class="odd">
<td>55</td>
<td align="left">negativeIncrease</td>
<td align="left">Covid-Tracking Project</td>
</tr>
<tr class="even">
<td>56</td>
<td align="left">total</td>
<td align="left">Covid-Tracking Project</td>
</tr>
<tr class="odd">
<td>57</td>
<td align="left">totalTestResults</td>
<td align="left">Covid-Tracking Project</td>
</tr>
<tr class="even">
<td>58</td>
<td align="left">totalTestResultsIncrease</td>
<td align="left">Covid-Tracking Project</td>
</tr>
<tr class="odd">
<td>59</td>
<td align="left">posNeg</td>
<td align="left">Covid-Tracking Project</td>
</tr>
<tr class="even">
<td>60</td>
<td align="left">deathIncrease</td>
<td align="left">Covid-Tracking Project</td>
</tr>
<tr class="odd">
<td>61</td>
<td align="left">hospitalizedIncrease</td>
<td align="left">Covid-Tracking Project</td>
</tr>
<tr class="even">
<td>62</td>
<td align="left">hash</td>
<td align="left">Covid-Tracking Project</td>
</tr>
<tr class="odd">
<td>63</td>
<td align="left">commercialScore</td>
<td align="left">Covid-Tracking Project</td>
</tr>
<tr class="even">
<td>64</td>
<td align="left">negativeRegularScore</td>
<td align="left">Covid-Tracking Project</td>
</tr>
<tr class="odd">
<td>65</td>
<td align="left">negativeScore</td>
<td align="left">Covid-Tracking Project</td>
</tr>
<tr class="even">
<td>66</td>
<td align="left">positiveScore</td>
<td align="left">Covid-Tracking Project</td>
</tr>
<tr class="odd">
<td>67</td>
<td align="left">score</td>
<td align="left">Covid-Tracking Project</td>
</tr>
<tr class="even">
<td>68</td>
<td align="left">grade</td>
<td align="left">Covid-Tracking Project</td>
</tr>
<tr class="odd">
<td>69</td>
<td align="left">ST</td>
<td align="left">Covid-Tracking Project</td>
</tr>
</tbody>
</table>
<p>We have been using the <code>totalTestResults</code> variable.</p>
<pre class="r"><code>fign &lt;- ggplot(aggregate(totalTestResults ~ date, FUN=function(x) sum(!is.na(x)), data=cs)) +
  geom_line(aes(x=date, y=totalTestResults, colour=&quot;Tests&quot;), size=1.5) +
  geom_line(data=aggregate(cases ~ date, FUN=function(x) sum(!is.na(x)), data=cs),
            aes(x=date, y=cases, colour=&quot;Cases&quot;), size=1.3) +
  geom_line(data=aggregate(deaths ~ date, FUN=function(x) sum(!is.na(x)), data=cs),
            aes(x=date, y=deaths, colour=&quot;Deaths&quot;), size=1.3) +
            ylab(&quot;Number non-missing&quot;) +
            xlab(&quot;&quot;) + plottheme + ggtitle(&quot;Number of non-missing observations&quot;) + colors()

p &lt;- c(0.05, 0.25, 0.5, 0.75, 0.95)
adf &lt;- aggregate(totalTestResults ~ date,
                 FUN=function(x) quantile(x, probs=p,
                                          na.rm=TRUE), data=cs)

## The following code sucks and the fact that the equivalent loop
## doesn&#39;t work reflects all that is wrong with ggplot2 and the
## tidyverse
p &lt;- as.factor(p)
s &lt;- 1.5
figm &lt;- ggplot(adf) +
  geom_line(aes(x=date, y=adf$totalTestResults[,1], color=p[1]), size=s) +
  geom_line(aes(x=date, y=adf$totalTestResults[,2], color=p[2]), size=s) +
  geom_line(aes(x=date, y=adf$totalTestResults[,3], color=p[3]), size=s) +
  geom_line(aes(x=date, y=adf$totalTestResults[,4], color=p[4]), size=s) +
  geom_line(aes(x=date, y=adf$totalTestResults[,5], color=p[5]), size=s) +
  plottheme + scale_y_log10() + ylab(&quot;Cumulative tests&quot;) +
  colors() + ggtitle(&quot;Quantiles of cumulative tests&quot;) +
  geom_line(data=cs, aes(x=date, y=totalTestResults, group=state), alpha=0.2) +
  theme(legend.position=&quot;bottom&quot;)

grid.arrange(fign, figm, layout_matrix=matrix(1:2, nrow=2), heights=c(0.5,1))</code></pre>
<pre><code>## Warning: Use of `adf$totalTestResults` is discouraged. Use `totalTestResults` instead.

## Warning: Use of `adf$totalTestResults` is discouraged. Use `totalTestResults` instead.

## Warning: Use of `adf$totalTestResults` is discouraged. Use `totalTestResults` instead.

## Warning: Use of `adf$totalTestResults` is discouraged. Use `totalTestResults` instead.

## Warning: Use of `adf$totalTestResults` is discouraged. Use `totalTestResults` instead.</code></pre>
<pre><code>## Warning: Transformation introduced infinite values in continuous y-axis

## Warning: Transformation introduced infinite values in continuous y-axis</code></pre>
<pre><code>## Warning: Removed 2185 row(s) containing missing values (geom_path).</code></pre>
<p><img src="datasummary_files/figure-html/testplots-1.png" width="768" /></p>
<p>The top panel shows that states began reporting test numbers in early March at earliest, and test numbers are included for all states by mid March. A few states began reporting cases earlier than March, but mostly case reporting and test reporting coincide.</p>
<p>In the bottom panel, the thick colored lines are quantiles of total cumulative tests, and the gray lines are tests in each state.</p>
</div>
<div id="policies" class="section level1" number="3">
<h1 number="3"><span class="header-section-number">3</span> Policies</h1>
<pre class="r"><code>rvars &lt;- dataguide[dataguide$source==&quot;Raifman et al&quot;, &quot;name&quot;]
pols  &lt;- unique(cs[,c(&quot;state&quot;,&quot;fips&quot;,rvars)])
di &lt;- sapply(cs[,rvars], function(x) inherits(x,&quot;Date&quot;))
pvars &lt;- rvars[di]

tbl &lt;- cbind(sapply(pols[,pvars], function(x) sum(!is.na(x)), USE.NAMES=FALSE),
             sapply(pols[,pvars], function(x) min(x, na.rm=TRUE), USE.NAMES=FALSE),
             sapply(pols[,pvars], function(x) median(x, na.rm=TRUE), USE.NAMES=FALSE),
             sapply(pols[,pvars], function(x) max(x, na.rm=TRUE), USE.NAMES=FALSE))
tbl[,2:4] &lt;- as.character(as.Date(as.numeric(tbl[,2:4]), origin=as.Date(&quot;1970-01-01&quot;, format=&quot;%Y-%m-%d&quot;)))
rownames(tbl) &lt;- gsub(&quot;\\.&quot;,&quot; &quot;,pvars)
colnames(tbl) &lt;- c(&quot;N&quot;,&quot;Min&quot;,&quot;Median&quot;,&quot;Max&quot;)
kable(tbl, digits=0, caption=&quot;State Policies \\label{tab:policies}&quot;, )</code></pre>
<pre><code>## Warning in kable_styling(knitr::kable(tbl, ...), bootstrap_options = c(&quot;striped&quot;, : Please specify format in kable. kableExtra can
## customize either HTML or LaTeX outputs. See https://haozhu233.github.io/kableExtra/ for details.</code></pre>
<table>
<caption>State Policies </caption>
<thead>
<tr class="header">
<th></th>
<th align="left">N</th>
<th align="left">Min</th>
<th align="left">Median</th>
<th align="left">Max</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>State of emergency</td>
<td align="left">51</td>
<td align="left">2020-02-29</td>
<td align="left">2020-03-11</td>
<td align="left">2020-03-16</td>
</tr>
<tr class="even">
<td>Date closed K 12 schools</td>
<td align="left">51</td>
<td align="left">2020-03-13</td>
<td align="left">2020-03-17</td>
<td align="left">2020-04-03</td>
</tr>
<tr class="odd">
<td>Closed day cares</td>
<td align="left">15</td>
<td align="left">2020-03-16</td>
<td align="left">2020-03-23</td>
<td align="left">2020-04-06</td>
</tr>
<tr class="even">
<td>Date banned visitors to nursing homes</td>
<td align="left">30</td>
<td align="left">2020-03-09</td>
<td align="left">2020-03-16</td>
<td align="left">2020-04-06</td>
</tr>
<tr class="odd">
<td>Closed non essential businesses</td>
<td align="left">43</td>
<td align="left">2020-03-19</td>
<td align="left">2020-03-25</td>
<td align="left">2020-04-06</td>
</tr>
<tr class="even">
<td>Closed restaurants except take out</td>
<td align="left">48</td>
<td align="left">2020-03-15</td>
<td align="left">2020-03-17</td>
<td align="left">2020-04-03</td>
</tr>
<tr class="odd">
<td>Closed gyms</td>
<td align="left">49</td>
<td align="left">2020-03-16</td>
<td align="left">2020-03-20</td>
<td align="left">2020-04-03</td>
</tr>
<tr class="even">
<td>Closed movie theaters</td>
<td align="left">49</td>
<td align="left">2020-03-16</td>
<td align="left">2020-03-21</td>
<td align="left">2020-04-06</td>
</tr>
<tr class="odd">
<td>Stay at home shelter in place</td>
<td align="left">42</td>
<td align="left">2020-03-19</td>
<td align="left">2020-03-28</td>
<td align="left">2020-04-07</td>
</tr>
<tr class="even">
<td>End relax stay at home shelter in place</td>
<td align="left">39</td>
<td align="left">2020-04-24</td>
<td align="left">2020-05-18</td>
<td align="left">2020-06-19</td>
</tr>
<tr class="odd">
<td>Began to reopen businesses statewide</td>
<td align="left">50</td>
<td align="left">2020-04-20</td>
<td align="left">2020-05-07</td>
<td align="left">2020-06-05</td>
</tr>
<tr class="even">
<td>Reopen restaurants</td>
<td align="left">48</td>
<td align="left">2020-04-24</td>
<td align="left">2020-05-18</td>
<td align="left">2020-06-22</td>
</tr>
<tr class="odd">
<td>Reopened gyms</td>
<td align="left">44</td>
<td align="left">2020-04-24</td>
<td align="left">2020-05-18</td>
<td align="left">2020-07-13</td>
</tr>
<tr class="even">
<td>Reopened movie theaters</td>
<td align="left">37</td>
<td align="left">2020-04-27</td>
<td align="left">2020-06-01</td>
<td align="left">2020-07-13</td>
</tr>
<tr class="odd">
<td>Resumed elective medical procedures</td>
<td align="left">35</td>
<td align="left">2020-04-20</td>
<td align="left">2020-04-30</td>
<td align="left">2020-05-29</td>
</tr>
<tr class="even">
<td>Mandate face mask use by all individuals in public spaces</td>
<td align="left">35</td>
<td align="left">2020-04-08</td>
<td align="left">2020-06-26</td>
<td align="left">2020-08-05</td>
</tr>
<tr class="odd">
<td>Mandate face mask use by employees in public facing businesses</td>
<td align="left">44</td>
<td align="left">2020-04-03</td>
<td align="left">2020-05-01</td>
<td align="left">2020-08-03</td>
</tr>
<tr class="even">
<td>Stop Initiation of Evictions overall or due to COVID related issues</td>
<td align="left">30</td>
<td align="left">2020-03-16</td>
<td align="left">2020-03-24</td>
<td align="left">2020-05-30</td>
</tr>
<tr class="odd">
<td>Stop enforcement of evictions overall or due to COVID related issues</td>
<td align="left">29</td>
<td align="left">2020-03-15</td>
<td align="left">2020-03-24</td>
<td align="left">2020-06-08</td>
</tr>
<tr class="even">
<td>Renter grace period or use of security deposit to pay rent</td>
<td align="left">3</td>
<td align="left">2020-04-10</td>
<td align="left">2020-04-24</td>
<td align="left">2020-05-20</td>
</tr>
<tr class="odd">
<td>Order freezing utility shut offs</td>
<td align="left">34</td>
<td align="left">2020-03-12</td>
<td align="left">2020-03-19</td>
<td align="left">2020-04-13</td>
</tr>
<tr class="even">
<td>Froze mortgage payments</td>
<td align="left">1</td>
<td align="left">2020-03-21</td>
<td align="left">2020-03-21</td>
<td align="left">2020-03-21</td>
</tr>
<tr class="odd">
<td>Waived one week waiting period for unemployment insurance</td>
<td align="left">36</td>
<td align="left">2020-03-08</td>
<td align="left">2020-03-18</td>
<td align="left">2020-04-06</td>
</tr>
</tbody>
</table>
<pre class="r"><code>rvars &lt;- dataguide[dataguide$source==&quot;Raifman et al&quot;, &quot;name&quot;]
pols  &lt;- unique(cs[,c(&quot;state&quot;,&quot;fips&quot;,rvars)])
di &lt;- sapply(cs[,rvars], function(x) inherits(x,&quot;Date&quot;))
pols &lt;- rvars[di]

plotstatepolicies  &lt;- function(st) {
  sdf  &lt;- subset(cs, state==st)
  x  &lt;- c()
  labels &lt;- c()
  for (lbl in pols) {
    d &lt;- unique(sdf[,lbl])
    i &lt;- which(x==d)
    if (length(i)==0) {
      if (length(x)==0)
        x &lt;- d
      else
        x &lt;- c(x,d)
      labels &lt;- c(labels,lbl)
    } else {
      labels[i]  &lt;- paste(labels[i],lbl,sep=&quot;, &quot;)
    }
  }
  labels &lt;- labels[!is.na(x)]
  x &lt;- x[!is.na(x)]
  y &lt;- rep(1, length(x))
  fig &lt;- ggplot(sdf,aes(x=date))  +
    geom_line(aes(y=cases)) +
    geom_line(aes(y=deaths), colour=&quot;red&quot;) +
    xlim(startday,max(sdf$date)) +
    ylab(&quot;count&quot;) +
    scale_y_continuous(trans=&quot;log10&quot;) + plottheme + colors() +
    ggtitle(st)

  fig + annotate(&quot;text&quot;, x=x,y=y,label=gsub(&quot;\\.&quot;,&quot; &quot;,labels),
                 size=2, angle=90, hjust=0)

}

i &lt;- 0
for (st in unique(cs$state)) {
  if (i == 0) fig &lt;- list()
  fig &lt;- c(fig, list(plotstatepolicies(st)))
  i &lt;- i+1
  if (i %% 3 == 0) {
    grid.arrange(grobs=fig, nrow=3, ncol=1)
    i = 0
  }
}</code></pre>
<p><img src="datasummary_files/figure-html/policyplot-1.png" width="768" /><img src="datasummary_files/figure-html/policyplot-2.png" width="768" /><img src="datasummary_files/figure-html/policyplot-3.png" width="768" /><img src="datasummary_files/figure-html/policyplot-4.png" width="768" /><img src="datasummary_files/figure-html/policyplot-5.png" width="768" /><img src="datasummary_files/figure-html/policyplot-6.png" width="768" /><img src="datasummary_files/figure-html/policyplot-7.png" width="768" /><img src="datasummary_files/figure-html/policyplot-8.png" width="768" /><img src="datasummary_files/figure-html/policyplot-9.png" width="768" /><img src="datasummary_files/figure-html/policyplot-10.png" width="768" /><img src="datasummary_files/figure-html/policyplot-11.png" width="768" /><img src="datasummary_files/figure-html/policyplot-12.png" width="768" /><img src="datasummary_files/figure-html/policyplot-13.png" width="768" /><img src="datasummary_files/figure-html/policyplot-14.png" width="768" /><img src="datasummary_files/figure-html/policyplot-15.png" width="768" /><img src="datasummary_files/figure-html/policyplot-16.png" width="768" /><img src="datasummary_files/figure-html/policyplot-17.png" width="768" /></p>
<pre class="r"><code>if (i != 0) {
  fig &lt;- c(fig, rep(list(ggplot() + plottheme), 3-i))
  grid.arrange(grobs=fig, nrow=3, ncol=1)
}</code></pre>
<pre class="r"><code>df &lt;- cs[order(cs$state,cs$date),]
pdates &lt;- c(&quot;Date.closed.K.12.schools&quot;,
            &quot;Stay.at.home..shelter.in.place&quot;,
            &quot;Closed.movie.theaters&quot;,
            &quot;Closed.restaurants.except.take.out&quot;,
            &quot;Closed.non.essential.businesses&quot;,
            &quot;Mandate.face.mask.use.by.all.individuals.in.public.spaces&quot;,
            &quot;Mandate.face.mask.use.by.employees.in.public.facing.businesses&quot;,
            &quot;State.of.emergency&quot;)
enddates &lt;- c(NA,
              &quot;End.relax.stay.at.home.shelter.in.place&quot;,
              &quot;Reopened.movie.theaters&quot;,
              &quot;Reopen.restaurants&quot;,
              &quot;Began.to.reopen.businesses.statewide&quot;,
              NA,
              NA,
              NA)
stopifnot(length(enddates)==length(pdates))

pvars &lt;- c(&quot;pk12&quot;, &quot;pshelter&quot;, &quot;pmovie&quot;, &quot;prestaurant&quot;, &quot;pnonessential&quot;,
           &quot;pmaskall&quot;,&quot;pmaskbus&quot;, &quot;psoe&quot;)
for(i in 1:length(pdates)) df[,pvars[i]] &lt;-
                             smoothedpolicy(df,pdates[i],enddatevar=enddates[i],type=&quot;ma&quot;,bw=0)

pols &lt;- c(&quot;psoe&quot;,&quot;pmaskbus&quot;,&quot;pk12&quot;, &quot;pshelter&quot;, &quot;pmovie&quot;, &quot;prestaurant&quot;, &quot;pnonessential&quot;)

ppplot &lt;- function(pol, df) {
  df$y &lt;- df[,pol]
  adf &lt;- aggregate(y ~ date, data=df, function(x) mean(x, na.rm=TRUE))
  fig &lt;- ggplot(adf, aes(x=date, y=y)) + geom_line(size=1.2) +
    plottheme + ylab(&quot;Portion of States&quot;) +
    colors() + ggtitle(varlabels[varlabels$Variable==pol,&quot;Label&quot;]) +
    theme(legend.position=&quot;none&quot;) +
    xlim(startday, max(df$date)) + ylim(0,1)
  return(fig)
}
figs &lt;- lapply(pols,function(p) ppplot(p, df))

for (i in 1:length(pols)) {
  pdf(sprintf(&quot;%s/tex/tables_and_figures/%s_p.pdf&quot;,rootdir, pols[i]), width=4, height=2)
  print(figs[[i]])
  dev.off()
}
grid.arrange(grobs=figs[2:7], nrow=3, ncol=2)</code></pre>
<p><img src="datasummary_files/figure-html/npolicies-1.png" width="768" /></p>
</div>
<div id="social-distancing-measures" class="section level1" number="4">
<h1 number="4"><span class="header-section-number">4</span> Social Distancing Measures</h1>
<pre class="r"><code>gv &lt;- dataguide$name[dataguide$source==&quot;Google Mobility Reports&quot;]
gv &lt;- gv[grep(&quot;_change_from_baseline&quot;,gv)]
hv &lt;- dataguide$name[dataguide$source==&quot;Homebase&quot;]</code></pre>
<div id="google-mobility-reports" class="section level2" number="4.1">
<h2 number="4.1"><span class="header-section-number">4.1</span> Google Mobility Reports</h2>
<pre class="r"><code>## fign &lt;-
##   ggplot(aggregate(retail_and_recreation_percent_change_from_baseline
##                    ~ date,
##                    FUN=function(x) sum(!is.na(x)), data=cs)) +
##   geom_line(aes(x=date, y=retail_and_recreation_percent_change_from_baseline), size=1) +
##   ylab(&quot;Number non-missing&quot;) +
##   theme(legend.position = &quot;none&quot;) +
##   xlab(&quot;&quot;) + plottheme + ggtitle(&quot;Number of non-missing observations of Google Mobility Reports&quot;) +
##   colors() + xlim(startday, max(cs$date))
## fign

quantileplot &lt;- function(v, p=c(0.05, 0.25, 0.5, 0.75, 0.95), data=cs) {
  data$y &lt;- data[,v]
  adf &lt;- aggregate(y ~ date, data=data,
                   FUN=function(x) quantile(x, probs=p, na.rm=TRUE))
  p &lt;- as.factor(p)
  s &lt;- 1.2
  txt &lt;- data.frame(date=max(adf$date), y=adf$y[nrow(adf$y),], p=p)
  names(adf)[1] &lt;- &quot;date&quot;
  figm &lt;- ggplot(adf) +
    geom_line(aes(x=date, y=adf$y[,1], color=p[1]), size=s) +
    geom_line(aes(x=date, y=adf$y[,2], color=p[2]), size=s) +
    geom_line(aes(x=date, y=adf$y[,3], color=p[3]), size=s) +
    geom_line(aes(x=date, y=adf$y[,4], color=p[4]), size=s) +
    geom_line(aes(x=date, y=adf$y[,5], color=p[5]), size=s) +
    geom_text(data=txt,aes(x=date,y=y,color=p, label=p,
                           hjust=&quot;left&quot;,vjust=&quot;center&quot;, size=2)) +
    plottheme + ylab(&quot;Percent Change&quot;) +
    colors() + ggtitle(TeX(paste(&quot;Evolution of&quot;,
                             varlabels[varlabels$Variable==v,&quot;Label&quot;]))) +
    geom_line(data=data, aes(x=date, y=y, group=state), alpha=0.2) +
    theme(legend.position=&quot;none&quot;) +
    #labs(color=&#39;Quantile&#39;)  +
   # xlim(startday, max(data$date))
  xlim(startday,as.Date(&quot;2020-06-03&quot;))
}

figm &lt;- lapply(gv, quantileplot)

for (i in seq(1,length(figm),by=2)) {
  grid.arrange(grobs=figm[i:(i+1)], nrow=2)
}</code></pre>
<p><img src="datasummary_files/figure-html/gplots-1.png" width="768" /><img src="datasummary_files/figure-html/gplots-2.png" width="768" /><img src="datasummary_files/figure-html/gplots-3.png" width="768" /></p>
<pre class="r"><code>for (i in 1:length(figm)) {
  vl &lt;- strsplit(gv[i],&quot;_&quot;)[[1]][1]
  pdf(sprintf(&quot;%s/tex/tables_and_figures/%s.pdf&quot;,rootdir,vl), width=7, height=3.5)
  print(figm[[i]])
  dev.off()
}</code></pre>
<p>The following figure shows the residuals from projecting each of the above variables on the social distancing metrics we use in our main analysis,</p>
<pre class="r"><code>sdused &lt;- c(#&quot;residential_percent_change_from_baseline&quot;,
    &quot;retail_and_recreation_percent_change_from_baseline&quot;,
    &quot;transit_stations_percent_change_from_baseline&quot;,
    &quot;workplaces_percent_change_from_baseline&quot;,
    &quot;grocery_and_pharmacy_percent_change_from_baseline&quot;)
kable(t(varlabels[sapply(sdused, function(x) which(x==varlabels$Variable)),&quot;Label&quot;]))</code></pre>
<pre><code>## Warning in kable_styling(knitr::kable(tbl, ...), bootstrap_options = c(&quot;striped&quot;, : Please specify format in kable. kableExtra can
## customize either HTML or LaTeX outputs. See https://haozhu233.github.io/kableExtra/ for details.</code></pre>
<table>
<tbody>
<tr class="odd">
<td align="left">retail intensity</td>
<td align="left">transit intensity</td>
<td align="left">workplaces intensity</td>
<td align="left">grocery intensity</td>
</tr>
</tbody>
</table>
<p>no smoothing is used in the figure.</p>
<p>The table shows the <span class="math inline">\(R^2\)</span> from regressing each of the social distance measures on the ones used in our main regressions. We report this both with and without smoothing.</p>
<pre class="r"><code>residanalysis &lt;- function(yvars, xvars=sdused, df=cs) {

  madf &lt;- df[,c(&quot;state&quot;,&quot;date&quot;,yvars,xvars)]
  for(v in c(yvars, xvars)) {
    madf[,v] &lt;- panelma(madf[,v], madf$state, madf$date, 7)
  }

  r &lt;- lapply(yvars, function(v) {
    if (v %in% xvars) {
      list(r.squared=1, r.squared.ma=1, residuals=rep(0,nrow(df)))
    } else {
      m &lt;- lm(as.formula(paste(v,&quot;~&quot;,
                               paste(xvars, collapse=&quot; + &quot;), sep=&quot; &quot;)),
              data=df,na.action=na.exclude)
      ma &lt;- lm(as.formula(paste(v,&quot;~&quot;,
                               paste(xvars, collapse=&quot; + &quot;), sep=&quot; &quot;)),
               data=madf,na.action=na.exclude)
      list(r.squared=summary(m)$r.squared,
           r.squared.ma=summary(ma)$r.squared,
           residuals=residuals(m))
    }
  })

  tmp &lt;- data.frame()
  for (i in 1:length(yvars)) {
    tmp &lt;- rbind(tmp,
                 data.frame(var=varlabels[varlabels$Variable==yvars[i],&quot;Label&quot;],
                            date=df$date, state=df$state,
                            residuals=r[[i]]$residuals))
  }
  tbl &lt;- t(matrix(c(sapply(r, function(x) x$r.squared),
                    sapply(r, function(x) x$r.squared.ma)),
                 nrow=length(yvars)))
  colnames(tbl) &lt;- varlabels[sapply(yvars, function(x) which(x==varlabels$Variable)),&quot;Label&quot;]
  rownames(tbl) &lt;- c(&quot;No smoothing&quot;, &quot;7 day moving average&quot;)

  fig &lt;- ggplot(tmp, aes(x=date, y=residuals,color=var)) +
    geom_point(alpha=0.7) + colors() + plottheme + ylab(&quot;Residuals&quot;) +
    labs(color=&quot;&quot;) + theme(legend.position=c(0.05, 0.95)) +
    xlim(as.Date(&quot;2020-03-01&quot;),max(df$date))
  return(list(fig, tbl))
}

out &lt;- residanalysis(gv, sdused)

kable(out[[2]],
      caption=&quot;Variance explained by Google Mobility measures used in regressions&quot;)</code></pre>
<pre><code>## Warning in kable_styling(knitr::kable(tbl, ...), bootstrap_options = c(&quot;striped&quot;, : Please specify format in kable. kableExtra can
## customize either HTML or LaTeX outputs. See https://haozhu233.github.io/kableExtra/ for details.</code></pre>
<table>
<caption>Variance explained by Google Mobility measures used in regressions</caption>
<thead>
<tr class="header">
<th></th>
<th align="right">retail intensity</th>
<th align="right">grocery intensity</th>
<th align="right">parks intensity</th>
<th align="right">transit intensity</th>
<th align="right">workplaces intensity</th>
<th align="right">residential intensity</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>No smoothing</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0.3825406</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0.8929607</td>
</tr>
<tr class="even">
<td>7 day moving average</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0.5980571</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0.9293918</td>
</tr>
</tbody>
</table>
<pre class="r"><code>out[[1]]</code></pre>
<pre><code>## Warning: Removed 12312 rows containing missing values (geom_point).</code></pre>
<p><img src="datasummary_files/figure-html/unnamed-chunk-7-1.png" width="768" /></p>
</div>
<div id="homebase" class="section level2" number="4.2">
<h2 number="4.2"><span class="header-section-number">4.2</span> Homebase</h2>
<pre class="r"><code>## fign &lt;-
##   ggplot(aggregate(percentchangehours ~ date,
##                    FUN=function(x) sum(!is.na(x)), data=cs)) +
##   geom_line(aes(x=date, y=percentchangehours), size=1) +
##   ylab(&quot;Number non-missing&quot;) +
##   theme(legend.position = &quot;none&quot;) +
##   xlab(&quot;&quot;) + plottheme + ggtitle(&quot;Number of non-missing observations of HomeBase Variables&quot;) +
##   colors() + xlim(startday, max(cs$date))
## fign

figm &lt;- lapply(hv, quantileplot)
grid.arrange(grobs=figm, nrow=2)</code></pre>
<p><img src="datasummary_files/figure-html/hplots-1.png" width="768" /></p>
<pre class="r"><code>out &lt;- residanalysis(hv, sdused)

kable(out[[2]],
      caption=&quot;Variance explained by Google Mobility measures used in regressions&quot;)</code></pre>
<table>
<caption>Variance explained by Google Mobility measures used in regressions</caption>
<thead>
<tr class="header">
<th></th>
<th align="right">% change hours</th>
<th align="right">% change businesses</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>No smoothing</td>
<td align="right">0.8764134</td>
<td align="right">0.8603747</td>
</tr>
<tr class="even">
<td>7 day moving average</td>
<td align="right">0.9224124</td>
<td align="right">0.9222370</td>
</tr>
</tbody>
</table>
<pre class="r"><code>out[[1]]</code></pre>
<p><img src="datasummary_files/figure-html/hplots-2.png" width="768" /></p>
<!-- ## Unacast -->
<!-- ```{r uplots, cache=TRUE, warning=FALSE} -->
<!-- ## fign <- -->
<!-- ##   ggplot(aggregate(encounters_rate ~ date, -->
<!-- ##                    FUN=function(x) sum(!is.na(x)), data=cs)) + -->
<!-- ##   geom_line(aes(x=date, y=encounters_rate), size=1) + -->
<!-- ##   ylab("Number non-missing") + -->
<!-- ##   theme(legend.position = "none") + -->
<!-- ##   xlab("") + plottheme + ggtitle("Number of non-missing observations of Unacast Variables") + -->
<!-- ##   colors() + xlim(startday, max(cs$date)) -->
<!-- ## fign -->
<!-- figm <- lapply(uv, quantileplot) -->
<!-- figm <- lapply(figm, function(x) x + ylab("")) -->
<!-- for (i in seq(1,length(figm), by=2)) { -->
<!--   grid.arrange(grobs=figm[i:(i+1)], nrow=2) -->
<!-- } -->
<!-- out <- residanalysis(uv, sdused) -->
<!-- kable(out[[2]], -->
<!--       caption="Variance explained by Google Mobility measures used in regressions") -->
<!-- out[[1]] -->
<!-- ``` -->
<!-- ## SafeGraph -->
<!-- ```{r splots, cache=TRUE, warning=FALSE} -->
<!-- sv <- c("distance_traveled_from_home", "completely_home_device_count", -->
<!--         "median_home_dwell_time", "part_time_work_behavior_devices", -->
<!--         "full_time_work_behavior_devices","portion_completely_home", -->
<!--         "portion_full_time_work", "portion_part_time_work") -->
<!-- cs$portion_completely_home <- -->
<!--   cs$completely_home_device_count/cs$device_count -->
<!-- cs$portion_full_time_work <- -->
<!--   cs$full_time_work_behavior_devices/cs$device_count -->
<!-- cs$portion_part_time_work <- -->
<!--   cs$part_time_work_behavior_devices/cs$device_count -->
<!-- ## fign <- -->
<!-- ##   ggplot(aggregate(distance_traveled_from_home ~ date, -->
<!-- ##                    FUN=function(x) sum(!is.na(x)), data=cs)) + -->
<!-- ##   geom_line(aes(x=date, y=distance_traveled_from_home), size=1) + -->
<!-- ##   ylab("Number non-missing") + -->
<!-- ##   theme(legend.position = "none") + -->
<!-- ##   xlab("") + plottheme + -->
<!-- ##   ggtitle("Number of non-missing observations of Safegraph Variables") + -->
<!-- ##   colors() + xlim(startday, max(cs$date)) -->
<!-- ## fign -->
<!-- figm <- lapply(sv, quantileplot) -->
<!-- figm <- lapply(figm, function(x) x + ylab("")) -->
<!-- for (i in seq(1,length(figm), by=2)) { -->
<!--   grid.arrange(grobs=figm[i:(i+1)], nrow=2) -->
<!-- } -->
<!-- out <- residanalysis(sv, sdused) -->
<!-- kable(out[[2]], -->
<!--       caption="Variance explained by Google Mobility measures used in regressions") -->
<!-- out[[1]] -->
<!-- ``` -->
</div>
</div>
<div id="variables" class="section level1" number="5">
<h1 number="5"><span class="header-section-number">5</span> Variables</h1>
<pre class="r"><code>source(paste(rootdir,&quot;cases_and_policies/rmd/varlabels.R&quot;, sep=&quot;/&quot;))
kable(varlabels)</code></pre>
<pre><code>## Warning in kable_styling(knitr::kable(tbl, ...), bootstrap_options = c(&quot;striped&quot;, : Please specify format in kable. kableExtra can
## customize either HTML or LaTeX outputs. See https://haozhu233.github.io/kableExtra/ for details.</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">Variable</th>
<th align="left">Label</th>
<th align="left">Description</th>
<th align="left">Source</th>
<th align="left">in.regressions</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">dlogdc</td>
<td align="left"><span class="math inline">\(\Delta \log \Delta C_{it}\)</span></td>
<td align="left">log(cases[t]-cases[t-7]) - log(cases[t-7] - cases[t-14])</td>
<td align="left">NYT</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">dlogdd</td>
<td align="left"><span class="math inline">\(\Delta \log \Delta D_{it}\)</span></td>
<td align="left">log(deaths[t]-deaths[t-7]) - log(deaths[t-7] - deaths[t-14])</td>
<td align="left">NYT</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="left">dlogtests</td>
<td align="left"><span class="math inline">\(\Delta \log T_{it}\)</span></td>
<td align="left">log(tests from t to t-7) - log(tests from t-7 to t-14)</td>
<td align="left">Covid Tracking Project</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">testrate</td>
<td align="left">tests per 1000</td>
<td align="left">tests in past week per 1000 people</td>
<td align="left">Covid Tracking Project</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="left">logdc</td>
<td align="left"><span class="math inline">\(\log \Delta C_{it}\)</span></td>
<td align="left">log(cases[t]-cases[t-7])</td>
<td align="left">NYT</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">logdd</td>
<td align="left"><span class="math inline">\(\log \Delta D_{it}\)</span></td>
<td align="left">log(deaths[t]-deaths[t-7])</td>
<td align="left">NYT</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="left">logt</td>
<td align="left">log(days since 2020-01-15)</td>
<td align="left">log(days since January 15, 2020)</td>
<td align="left"></td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">testratedc</td>
<td align="left"><span class="math inline">\(\frac{\Delta{D}}{\Delta{C}} T_{it}\)</span></td>
<td align="left">tests in past week time deaths in past week divided by cases in past week</td>
<td align="left">NYT, Covid Tracking Project</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="left">Population.2018</td>
<td align="left">population</td>
<td align="left">Population in 2018</td>
<td align="left">Raifman et al</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">Square.Miles</td>
<td align="left">square miles</td>
<td align="left">State area in square miles</td>
<td align="left">Raifman et al</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="left">Percent.Unemployed..2018.</td>
<td align="left">Unemployment</td>
<td align="left">State unemployment in 2018</td>
<td align="left">Raifman et al</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">Percent.living.under.the.federal.poverty.line..2018.</td>
<td align="left">Poverty</td>
<td align="left">% under poverty line in 2018</td>
<td align="left">Raifman et al</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="left">Percent.at.risk.for.serious.illness.due.to.COVID</td>
<td align="left">Comorbidity</td>
<td align="left">% at risk for serious illness due to COVID</td>
<td align="left">Raifman et al</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">pmovie</td>
<td align="left">closed movie theaters</td>
<td align="left">closed movie theaters</td>
<td align="left">Raifman et al</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="left">pshelter</td>
<td align="left">stay at home</td>
<td align="left">stay at home / shelter in place</td>
<td align="left">Raifman et al</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">pk12</td>
<td align="left">closed K-12 schools</td>
<td align="left">closed K-12 schools</td>
<td align="left">Raifman et al</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="left">prestaurant</td>
<td align="left">closed restaurants</td>
<td align="left">closed restaurants except takeout</td>
<td align="left">Raifman et al</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">pnonessential</td>
<td align="left">closed non-essent bus</td>
<td align="left">closed non-essential businesses</td>
<td align="left">Raifman et al</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="left">psoe</td>
<td align="left">state of emergency</td>
<td align="left">state of emergency</td>
<td align="left">Raifman et al</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">pindex</td>
<td align="left">business closure policies</td>
<td align="left">the average of closures of movie theaters,</td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">reataurants, and non-essential businesses Raifman</td>
<td align="left">et al TRUE</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">party</td>
<td align="left">Governor’s party</td>
<td align="left">Governor’s party</td>
<td align="left">OPENICPSR</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="left">vote</td>
<td align="left">Trump voting shares</td>
<td align="left">Trump voting shares</td>
<td align="left">MIT Election Lab</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">logvote</td>
<td align="left">log(Trump voting shares)</td>
<td align="left">log(Trump voting shares)</td>
<td align="left">MIT Election Lab</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="left">z.mask</td>
<td align="left">mask wearing rates</td>
<td align="left">z-score for mask wearing rates</td>
<td align="left">YouGov</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">mask_percent</td>
<td align="left">mask wearing rates</td>
<td align="left">mask wearing rates</td>
<td align="left">YouGov</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="left">pmaskbus</td>
<td align="left">masks for employees</td>
<td align="left">mandate face mask use by employees in public facing businesses</td>
<td align="left">Raifman et al</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">pmask.april</td>
<td align="left">masks*April</td>
<td align="left"></td>
<td align="left">Raifman et al</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="left">pmask.may</td>
<td align="left">masks*May</td>
<td align="left"></td>
<td align="left">Raifman et al</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">pmaskall</td>
<td align="left">masks in public spaces</td>
<td align="left">mandate face mask use by all individuals in public spaces</td>
<td align="left">Raifman et al</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="left">workplaces</td>
<td align="left">workplaces</td>
<td align="left">workplaces percent change from baseline</td>
<td align="left">Google</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">residential</td>
<td align="left">residential</td>
<td align="left">residential percent change from baseline</td>
<td align="left">Google</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="left">retail</td>
<td align="left">retail</td>
<td align="left">retail and recreation percent change from baseline</td>
<td align="left">Google</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">grocery</td>
<td align="left">grocery</td>
<td align="left">grocery and pharmacy percent change from baseline</td>
<td align="left">Google</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="left">transit</td>
<td align="left">transit</td>
<td align="left">transit percent change from baseline</td>
<td align="left">Google</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">workplaces_percent_change_from_baseline</td>
<td align="left">workplaces intensity</td>
<td align="left">workplaces percent change from baseline</td>
<td align="left">Google</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="left">residential_percent_change_from_baseline</td>
<td align="left">residential intensity</td>
<td align="left">residential percent change from baseline</td>
<td align="left">Google</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="left">retail_and_recreation_percent_change_from_baseline</td>
<td align="left">retail intensity</td>
<td align="left">retail and recreation percent change from baseline</td>
<td align="left">Google</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="left">grocery_and_pharmacy_percent_change_from_baseline</td>
<td align="left">grocery intensity</td>
<td align="left">grocery and pharmacy percent change from baseline</td>
<td align="left">Google</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="left">transit_stations_percent_change_from_baseline</td>
<td align="left">transit intensity</td>
<td align="left">transit percent change from baseline</td>
<td align="left">Google</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="left">parks_percent_change_from_baseline</td>
<td align="left">parks intensity</td>
<td align="left">parks percent change from baseline</td>
<td align="left">Google</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="left">percentchangehours</td>
<td align="left">% change hours</td>
<td align="left"></td>
<td align="left">Homebase</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="left">percentchangebusinesses</td>
<td align="left">% change businesses</td>
<td align="left"></td>
<td align="left">Homebase</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="left">distance_traveled_from_home</td>
<td align="left">distance traveled</td>
<td align="left"></td>
<td align="left">Safegraph</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="left">completely_home_device_count</td>
<td align="left">Completely home count</td>
<td align="left"></td>
<td align="left">Safegraph</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="left">median_home_dwell_time</td>
<td align="left">Median home dwell time</td>
<td align="left"></td>
<td align="left">Safegraph</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="left">part_time_work_behavior_devices</td>
<td align="left">Part-time count</td>
<td align="left"></td>
<td align="left">Safegraph</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="left">full_time_work_behavior_devices</td>
<td align="left">Full-time count</td>
<td align="left"></td>
<td align="left">Safegraph</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="left">portion_completely_home</td>
<td align="left">Completely home portion</td>
<td align="left"></td>
<td align="left">Safegraph</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="left">portion_full_time_work</td>
<td align="left">Full-time portion</td>
<td align="left"></td>
<td align="left">Safegraph</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="left">portion_part_time_work</td>
<td align="left">Part-time portion</td>
<td align="left"></td>
<td align="left">Safegraph</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="left">daily_distance_diff</td>
<td align="left">Distance change</td>
<td align="left"></td>
<td align="left">Unacast</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="left">daily_visitation_diff</td>
<td align="left">Visits change</td>
<td align="left"></td>
<td align="left">Unacast</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="left">encounters_rate</td>
<td align="left">Encounters rate</td>
<td align="left"></td>
<td align="left">Unacast</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="left">log_encounters_rate</td>
<td align="left">log(1+encounters rate)</td>
<td align="left"></td>
<td align="left">Unacast</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="left">zero</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="left">(0.000)</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left">FALSE</td>
</tr>
</tbody>
</table>
</div>
<div id="case-and-death-growth" class="section level1" number="6">
<h1 number="6"><span class="header-section-number">6</span> Case and death growth</h1>
<pre class="r"><code>source(paste(rootdir,&quot;cases_and_policies/R/dataprep.R&quot;,sep=&quot;/&quot;))</code></pre>
<pre><code>## Loading data last updated on  2020-09-11 09:51:34 
## Run  /home/paul/covid-impact/cases_and_policies/R/cases_and_policies.R  to update data.</code></pre>
<pre class="r"><code>source(paste(rootdir,&quot;cases_and_policies/rmd/varlabels.R&quot;, sep=&quot;/&quot;))
source(paste(rootdir,&quot;cases_and_policies/rmd/regprep.R&quot;, sep=&quot;/&quot;))</code></pre>
<pre><code>## Warning in eval(ei, envir): Using data only up to 2020-06-03. Modify lines 4-5 of regprep.R to change</code></pre>
<pre class="r"><code>fig &lt;- quantileplot(&quot;dlogdc&quot;, data=df) + ylab(&quot;&quot;) + xlim(c(as.Date(&quot;2020-03-01&quot;),max(df$date+3)))</code></pre>
<pre><code>## Scale for &#39;x&#39; is already present. Adding another scale for &#39;x&#39;, which will replace the existing scale.</code></pre>
<pre class="r"><code>pdf(sprintf(&quot;%s/tex/tables_and_figures/casequantiles.pdf&quot;,rootdir), width=7, height=3.5)
print(fig)</code></pre>
<pre><code>## Warning: Use of `adf$y` is discouraged. Use `y` instead.</code></pre>
<pre><code>## Warning: Use of `adf$y` is discouraged. Use `y` instead.

## Warning: Use of `adf$y` is discouraged. Use `y` instead.

## Warning: Use of `adf$y` is discouraged. Use `y` instead.

## Warning: Use of `adf$y` is discouraged. Use `y` instead.</code></pre>
<pre><code>## Warning: Removed 26 row(s) containing missing values (geom_path).

## Warning: Removed 26 row(s) containing missing values (geom_path).

## Warning: Removed 26 row(s) containing missing values (geom_path).

## Warning: Removed 26 row(s) containing missing values (geom_path).

## Warning: Removed 26 row(s) containing missing values (geom_path).</code></pre>
<pre><code>## Warning: Removed 1990 row(s) containing missing values (geom_path).</code></pre>
<pre class="r"><code>dev.off()</code></pre>
<pre><code>## png 
##   2</code></pre>
<pre class="r"><code>fig &lt;- quantileplot(&quot;dlogdd&quot;, data=df) + ylab(&quot;&quot;) + xlim(c(as.Date(&quot;2020-03-01&quot;),max(df$date+3)))</code></pre>
<pre><code>## Scale for &#39;x&#39; is already present. Adding another scale for &#39;x&#39;, which will replace the existing scale.</code></pre>
<pre class="r"><code>pdf(sprintf(&quot;%s/tex/tables_and_figures/deathquantiles.pdf&quot;,rootdir), width=7, height=3.5)
print(fig)</code></pre>
<pre><code>## Warning: Use of `adf$y` is discouraged. Use `y` instead.</code></pre>
<pre><code>## Warning: Use of `adf$y` is discouraged. Use `y` instead.

## Warning: Use of `adf$y` is discouraged. Use `y` instead.

## Warning: Use of `adf$y` is discouraged. Use `y` instead.

## Warning: Use of `adf$y` is discouraged. Use `y` instead.</code></pre>
<pre><code>## Warning: Removed 26 row(s) containing missing values (geom_path).

## Warning: Removed 26 row(s) containing missing values (geom_path).

## Warning: Removed 26 row(s) containing missing values (geom_path).

## Warning: Removed 26 row(s) containing missing values (geom_path).

## Warning: Removed 26 row(s) containing missing values (geom_path).</code></pre>
<pre><code>## Warning: Removed 1990 row(s) containing missing values (geom_path).</code></pre>
<pre class="r"><code>dev.off()</code></pre>
<pre><code>## png 
##   2</code></pre>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
